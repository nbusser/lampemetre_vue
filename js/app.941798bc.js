(function(e){function t(t){for(var r,u,i=t[0],s=t[1],c=t[2],d=0,b=[];d<i.length;d++)u=i[d],Object.prototype.hasOwnProperty.call(o,u)&&o[u]&&b.push(o[u][0]),o[u]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(b.length)b.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},o={app:0},a=[];function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/lampemetre_vue/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var l=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"093c":function(e,t,n){},"1d9b":function(e,t,n){"use strict";n("b768")},2275:function(e,t,n){"use strict";n("dd09")},"259b":function(e,t,n){"use strict";n("bfc8")},"26e3":function(e,t,n){},"2d51":function(e,t,n){},"43d1":function(e,t,n){"use strict";n("2d51")},"4bf0":function(e,t,n){},"4e54":function(e,t,n){e.exports=n.p+"media/bell.325fdc52.mp3"},"6a72":function(e,t,n){"use strict";n("093c")},"9b8a":function(e,t,n){},a94e:function(e,t,n){"use strict";n("9b8a")},acad:function(e,t,n){},b107:function(e,t,n){},b768:function(e,t,n){},bfc8:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("b107");var r=n("7a23"),o=n("7b17"),a={class:"toast-container position-absolute p-3 top-50 end-0 translate-middle-y"},u={ref:"errorToast",class:"toast",role:"alert","data-bs-delay":"4000"},i={class:"toast-header"},s=Object(r["f"])("i",{class:"text-danger bi bi-exclamation-square-fill rounded me-2"},null,-1),c={class:"me-auto"},l=Object(r["f"])("small",null,"Erreur",-1),d=Object(r["f"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast"},null,-1),b={class:"toast-body"};function f(e,t,n,o,f,p){var m=Object(r["t"])("HeaderBar"),h=Object(r["t"])("Workspace");return Object(r["n"])(),Object(r["e"])(r["a"],null,[Object(r["h"])(m,{onErrorTriggered:e.triggerError},null,8,["onErrorTriggered"]),Object(r["h"])(h),Object(r["f"])("div",a,[Object(r["f"])("div",u,[Object(r["f"])("div",i,[s,Object(r["f"])("strong",c,Object(r["v"])(e.errorSource),1),l,d]),Object(r["f"])("div",b,Object(r["v"])(e.errorMessage),1)],512)])],64)}var p=function(e){return Object(r["p"])("data-v-6aa529e9"),e=e(),Object(r["o"])(),e},m={class:"d-flex mb-4 justify-content-between align-items-center"},h={class:"d-flex gap-8 justify-content-between align-items-center"},v=p((function(){return Object(r["f"])("h1",{class:"text-light m-0 py-1 px-3"},"Lampemètre",-1)}));function O(e,t,n,o,a,u){var i=Object(r["t"])("SaveLoad"),s=Object(r["t"])("Timer");return Object(r["n"])(),Object(r["e"])("header",m,[Object(r["f"])("div",h,[v,Object(r["h"])(i,{onErrorTriggered:t[0]||(t[0]=function(t){return e.$emit("errorTriggered",t)})})]),Object(r["h"])(s,{class:"timer me-4",timer:this.$store.state.timer},null,8,["timer"])])}var j=n("4e54"),g=n.n(j),C=function(e){return Object(r["p"])("data-v-2335b224"),e=e(),Object(r["o"])(),e},E={class:"d-inline-block text-center"},w={ref:"audioBell"},y=C((function(){return Object(r["f"])("source",{src:g.a,type:"audio/mpeg"},null,-1)})),x=[y],M={class:"timer_info"},T=Object(r["g"])(" Minuteur "),R=C((function(){return Object(r["f"])("i",{class:"bi bi-stopwatch"},null,-1)})),k=[T,R],A={class:"input-group mb-3"},S=C((function(){return Object(r["f"])("span",{class:"input-group-text"}," secondes ",-1)})),_=["disabled"],N=Object(r["g"])(" Reset "),$=C((function(){return Object(r["f"])("i",{class:"bi bi-arrow-clockwise"},null,-1)})),U=[N,$];function P(e,t,n,o,a,u){var i=this,s=Object(r["u"])("tooltip");return Object(r["n"])(),Object(r["e"])("div",E,[Object(r["f"])("audio",w,x,512),Object(r["f"])("div",M,[Object(r["f"])("button",Object(r["k"])({type:"button",class:"btn btn-lg btn-light",ref:"popoverBtn","data-bs-placement":"bottom"},Object(r["w"])({"shown.bs.popover":function(){i.popoverInitialized=!0}})),k,16),Object(r["A"])((Object(r["n"])(),Object(r["e"])("span",{class:Object(r["l"])(["seconds badge user-select-none",this.isBlinking?"bg-primary":"bg-secondary"]),ref:"timerSeconds",title:"Tant que le minuteur est actif, les nouvelles captures seront mises en attente.\n          Activez le pendant le chauffage des lampes","data-bs-toggle":"tooltip","data-bs-placement":"bottom"},[Object(r["g"])(Object(r["v"])(e.secondsLeft),1)],2)),[[s]])]),Object(r["f"])("div",{ref:"popoverContent",style:Object(r["m"])(e.setPopoverDisplay)},[Object(r["f"])("div",A,[Object(r["f"])("input",{class:"form-control",onChange:t[0]||(t[0]=function(){return e.updateInputValid&&e.updateInputValid.apply(e,arguments)}),onKeypress:t[1]||(t[1]=function(){return e.durationInputKeypressed&&e.durationInputKeypressed.apply(e,arguments)}),onInput:t[2]||(t[2]=function(){return e.updateInputValid&&e.updateInputValid.apply(e,arguments)}),value:"60",type:"text",ref:"inputDuration"},null,544),S,Object(r["f"])("button",{type:"button",class:"btn btn-outline-success",ref:"btnReset",disabled:!e.inputValid,onClick:t[3]||(t[3]=function(){return e.resetTimer&&e.resetTimer.apply(e,arguments)})},U,8,_)])],4)])}var I=n("1da1"),D=(n("96cf"),n("25eb"),n("a9e3"),n("9129"),n("d3b7"),n("d4ec")),B=n("bee2"),F=function(){function e(){Object(D["a"])(this,e),this.secondsLeft=0}return Object(B["a"])(e,[{key:"initInterval",value:function(){var e=this;setInterval((function(){e.updateTimer()}),1e3)}},{key:"resetTimer",value:function(e){this.secondsLeft=e}},{key:"updateTimer",value:function(){this.isOver()||(this.secondsLeft-=1)}},{key:"isOver",value:function(){return 0===this.secondsLeft}}]),e}(),L=Object(r["i"])({name:"Timer",data:function(){return{popover:null,popoverInitialized:!1,errorMessage:null,inputValid:!1,isBlinking:!1}},props:{timer:F},mounted:function(){void 0!==this.$refs.audioBell&&this.$refs.audioBell.load(),this.updateInputValid();var e=this.$refs.popoverBtn,t=this.$refs.popoverContent;this.popover=new o["b"](e,{sanitize:!1,html:!0,content:t}),this.popover.show(),this.popover.hide()},computed:{timerIsOver:function(){var e;return null===(e=this.timer)||void 0===e?void 0:e.isOver()},secondsLeft:function(){return void 0!==this.timer?(0===this.timer.secondsLeft&&void 0!==this.$refs.audioBell&&(this.$refs.audioBell.play(),this.blinkAnimation()),this.timer.secondsLeft.toLocaleString("fr",{minimumIntegerDigits:2,useGrouping:!1})):""},setPopoverDisplay:function(){var e=this.popoverInitialized?"":"none";return{display:e}}},methods:{resetTimer:function(){if(void 0!==this.timer){var e=this.$refs.inputDuration.value,t=Number.parseInt(e,10);this.timer.resetTimer(t),this.errorMessage=null,this.popover.hide()}},updateInputValid:function(){var e=!1;if(void 0!==this.$refs.inputDuration){var t=this.$refs.inputDuration.value,n=Number.parseInt(t,10);e=!Number.isNaN(n)}this.inputValid=e},durationInputKeypressed:function(e){this.updateInputValid(),13===e.keyCode&&this.$refs.btnReset.click()},blinkAnimation:function(){var e=arguments,t=this;return Object(I["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:0,o=12,a=150,n.next=5,new Promise((function(e){return setTimeout((function(){r<o?(t.isBlinking=r%2===0,t.blinkAnimation(r+1)):e(0)}),a)}));case 5:t.isBlinking=!1;case 6:case"end":return n.stop()}}),n)})))()}}}),G=(n("f27a"),n("6b0d")),V=n.n(G);const z=V()(L,[["render",P],["__scopeId","data-v-2335b224"]]);var q=z,J=function(e){return Object(r["p"])("data-v-60679c2d"),e=e(),Object(r["o"])(),e},H={class:"save_load dropdown"},K=J((function(){return Object(r["f"])("button",{class:"btn btn-light btn-lg dropdown-toggle",type:"button","data-bs-toggle":"dropdown","data-bs-auto-close":"true"},[Object(r["g"])(" Projet "),Object(r["f"])("i",{class:"bi bi-save"}),Object(r["f"])("i",{class:"bi"})],-1)})),Q={class:"dropdown-menu"},W={class:"dropdown-submenu"},Y=J((function(){return Object(r["f"])("a",{class:"dropdown-item",tabindex:"-1"}," Sauvegarder ",-1)})),X={class:"dropdown-menu"},Z=Object(r["g"])("JSON (.json) "),ee=J((function(){return Object(r["f"])("i",{class:"bi bi-filetype-json"},null,-1)})),te=[Z,ee],ne=Object(r["g"])("Excel (.xlsx) "),re=J((function(){return Object(r["f"])("i",{class:"bi bi-file-excel"},null,-1)})),oe=[ne,re],ae={class:"dropdown-submenu"},ue=J((function(){return Object(r["f"])("a",{class:"dropdown-item",tabindex:"-1"}," Charger ",-1)})),ie={class:"dropdown-menu"};function se(e,t,n,o,a,u){var i=Object(r["t"])("LoadFile");return Object(r["n"])(),Object(r["e"])("div",H,[K,Object(r["f"])("ul",Q,[Object(r["f"])("li",W,[Y,Object(r["f"])("ul",X,[Object(r["f"])("li",null,[Object(r["f"])("a",{onClick:t[0]||(t[0]=function(){return e.saveJSON&&e.saveJSON.apply(e,arguments)}),class:"dropdown-item"},te)]),Object(r["f"])("li",null,[Object(r["f"])("a",{onClick:t[1]||(t[1]=function(){return e.exportExcel&&e.exportExcel.apply(e,arguments)}),class:"dropdown-item"},oe)])])]),Object(r["f"])("li",ae,[ue,Object(r["f"])("ul",ie,[Object(r["h"])(i,{text:"JSON",accept:".json",readMethod:"text",iconClass:"bi bi-filetype-json",onFileLoaded:e.loadJSON,onErrorTriggered:t[2]||(t[2]=function(t){return e.$emit("errorTriggered",t)})},null,8,["onFileLoaded"]),Object(r["h"])(i,{text:"Excel",accept:".xlsx",readMethod:"array_buffer",iconClass:"bi bi-file-excel",onFileLoaded:e.importExcel,onErrorTriggered:t[3]||(t[3]=function(t){return e.$emit("errorTriggered",t)})},null,8,["onFileLoaded"])])])])])}var ce=n("2909"),le=(n("ddb0"),n("159b"),["accept"]);function de(e,t,n,o,a,u){return Object(r["n"])(),Object(r["e"])(r["a"],null,[Object(r["f"])("a",{class:"dropdown-item",onClick:t[0]||(t[0]=function(){return e.clickHandler&&e.clickHandler.apply(e,arguments)})},[Object(r["g"])(Object(r["v"])(e.text)+" ("+Object(r["v"])(e.accept)+") ",1),void 0!==e.iconClass?(Object(r["n"])(),Object(r["e"])("i",{key:0,class:Object(r["l"])(["bi",e.iconClass])},null,2)):Object(r["d"])("",!0)]),Object(r["f"])("input",{class:"d-none",type:"file",name:"file",onChange:t[1]||(t[1]=function(){return e.fileSelected&&e.fileSelected.apply(e,arguments)}),accept:e.accept,ref:"fileInput"},null,40,le)],64)}var be;n("d9e2");(function(e){e["ArrayBuffer"]="array_buffer",e["Text"]="text"})(be||(be={}));var fe=Object(r["i"])({name:"LoadFile",props:{text:String,accept:String,readMethod:String,iconClass:String},emits:["fileLoaded","errorTriggered"],methods:{clickHandler:function(){var e=this.$refs.fileInput;e.click()},emitError:function(){var e="Une erreur est survenue pendant la lecture du fichier",t="Chargement de fichier ".concat(this.$props.text);this.$emit("errorTriggered",{errorMessage:e,errorSource:t})},fileSelected:function(e){var t=this;if(null!==e.target){var n=e.target.files[0],r=new FileReader;if(r.addEventListener("load",(function(e){if(null!==e.target&&null!==e.target.result){var n=t.$refs.fileInput;n.value="",t.$emit("fileLoaded",e.target.result)}else t.emitError()})),this.readMethod===be.ArrayBuffer)r.readAsArrayBuffer(n);else{if(this.readMethod!==be.Text)throw this.emitError(),Error("No read method given as prop");r.readAsText(n)}}else this.emitError()}}});n("1d9b");const pe=V()(fe,[["render",de],["__scopeId","data-v-314612c4"]]);var me=pe,he=(n("bf19"),n("e9c4"),n("b0c0"),n("21a6")),ve=(n("4ec9"),n("3ca3"),n("99af"),n("25f0"),function(){function e(t,n,r){Object(D["a"])(this,e),this.uAnode=t,this.uGrid=n,this.iCathode=r}return Object(B["a"])(e,[{key:"toString",value:function(){return"-".concat(this.uGrid,"V")}}]),e}()),Oe=0,je=10,ge=function(){function e(t){Object(D["a"])(this,e),this.captures=new Map,this.selectedUgrid=null,this.smoothingFactor=4,this.name=t}return Object(B["a"])(e,[{key:"createCapture",value:function(e,t,n){var r=new ve(e,t,n);this.captures.has(t)&&this.deleteCaptureByUgrid(t),this.captures.set(t,r)}},{key:"deleteCapture",value:function(e){this.deleteCaptureByUgrid(e.uGrid)}},{key:"deleteCaptureByUgrid",value:function(e){var t=this.captures.get(e);if(void 0===t)throw Error("Capture for tension grid ".concat(e," does not belong to tube ").concat(this.name));this.captures.delete(e),e===this.selectedUgrid&&(this.selectedUgrid=null)}},{key:"changeSelectedUgrid",value:function(e){if(!this.captures.has(e))throw Error("No capture ".concat(e.toString()," for tube ").concat(this.name));this.selectedUgrid=e}},{key:"changeSmoothingFactor",value:function(e){if(e<Oe||e>je)throw Error("Smoothing factor must be between ".concat(Oe," and ").concat(je));if(this.captures.size>0)throw Error("Smoothing factor can only be changed if no capture is registered");this.smoothingFactor=e}},{key:"canChangeSmoothingFactor",value:function(){return 0===this.captures.size}},{key:"toJSON",value:function(){var e=Object(ce["a"])(this.captures.values());return{name:this.name,captures:0===e.length?void 0:e,selectedCaptureUgrid:null===this.selectedUgrid?void 0:this.selectedUgrid,smoothingFactor:this.smoothingFactor}}}]),e}(),Ce=function(e,t,n){var r=[];e.forEach((function(e){r.push(e.toJSON())}));var o={tubes:0===r.length?void 0:r,measurements:0===t.length?void 0:t,notes:n},a=JSON.stringify(o),u="save-".concat((new Date).valueOf(),".json");he["saveAs"](new Blob([a]),u)},Ee=function(e){var t=JSON.parse(e),n=[];void 0!==t.tubes&&t.tubes.forEach((function(e){var t=new ge(e.name);void 0!==e.smoothingFactor&&t.changeSmoothingFactor(e.smoothingFactor),void 0!==e.captures&&e.captures.forEach((function(e){t.createCapture(e.uAnode,e.uGrid,e.iCathode)})),void 0!==e.selectedCaptureUgrid&&t.changeSelectedUgrid(e.selectedCaptureUgrid),n.push(t)}));var r=[];return void 0!==t.measurements&&(r=t.measurements),{tubes:n,measurements:r,notes:t.notes}},we=(n("ac1f"),n("466d"),n("c35a"),n("e8ae")),ye=(n("c740"),n("4e82"),n("b680"),function(e){if(null===e.selectedUgrid)return"Selectionnez une capture en cliquant dessus dans le panneau Tubes";var t=e.captures.get(e.selectedUgrid);return void 0===t?"La capture ".concat(e.selectedUgrid," n'existe pas pour le tube ").concat(e.name):t}),xe=function(e,t){var n=e.findIndex((function(e){return e>=t}));return-1===n?null:0===n||Math.abs(t-e[n])<Math.abs(t-e[n-1])?n:n-1},Me=function(e,t){var n=xe(e.uAnode,t);if(null===n)throw Error("Aucun échantillon capturé au delà de la tension anode ".concat(t,"V"));return 0===n?n+=1:n===e.uAnode.length-1&&(n-=1),n},Te=function(e){var t=Object(ce["a"])(e.captures.values()).sort((function(e,t){return e.uGrid<t.uGrid?-1:e.uGrid>t.uGrid?1:0}));return t},Re=function(e,t){if(e.captures.size<1)return"Le tube doit contenir au moins une capture";var n=ye(e);if("string"===typeof n)return n;var r=Me(n,t);return Number.parseFloat(n.iCathode[r].toFixed(2))},ke=function(e,t){if(e.captures.size<1)return"Le tube doit contenir au moins une capture";var n=ye(e);if("string"===typeof n)return n;var r=Me(n,t),o=(n.uAnode[r]-n.uAnode[r-1])/(n.iCathode[r]-n.iCathode[r-1]),a=(n.uAnode[r+1]-n.uAnode[r])/(n.iCathode[r+1]-n.iCathode[r]);return(o+a)/2},Ae=function(e,t){if(e.captures.size<2)return"Le tube doit contenir au moins deux captures";var n=ye(e);if("string"===typeof n)return n;var r,o=Te(e),a=Me(n,t),u=n.iCathode[a],i=function(e){return Math.abs((u-e.iCathode[a])/(n.uGrid-e.uGrid))},s=o.findIndex((function(e){return e===n}));return r=i(0!==s?o[s-1]:o[s+1]),r},Se=function(e,t){if(e.captures.size<2)return"Le tube doit contenir au moins deux captures";var n=ye(e);if("string"===typeof n)return n;if(e.captures.size<2)return"Le tube doit contenir au moins deux captures";var r=Te(e),o=Me(n,t),a=n.iCathode[o],u=function(e){var r=xe(e.iCathode,a);return null===r?null:Math.abs((e.uAnode[r]-t)/(n.uGrid-e.uGrid))},i=r.findIndex((function(e){return e===n})),s=null;return 0!==i&&(s=u(r[i-1])),null===s&&(s=u(r[i+1])),null!==s?s:"Impossible de calculer le facteur d'amplification avec ces captures"},_e=function(e,t){var n=new we["Workbook"];n.creator="Lampemetre-web",n.created=new Date,n.modified=new Date,e.forEach((function(e){var t=n.addWorksheet(e.name),r=1;e.captures.forEach((function(n){for(var o=t.addTable({name:"".concat(e.name," ").concat(n.toString()),ref:t.getCell(1,r).address,headerRow:!0,totalsRow:!0,columns:[{name:"Tension Anode",totalsRowLabel:"",filterButton:!1},{name:"Intensité cathode (uGrid ".concat(n.uGrid,")"),totalsRowFunction:"none",filterButton:!1}],rows:[]}),a=0;a<n.uAnode.length;a+=1)o.addRow([n.uAnode[a],n.iCathode[a]]);o.commit(),r+=3}))}));var r=n.addWorksheet("Mesures"),o=r.addTable({name:"Measures",ref:"A1",headerRow:!0,totalsRow:!0,columns:[{name:"Tension anode mesure",totalsRowLabel:"",filterButton:!1},{name:"Nom du tube",totalsRowLabel:"",filterButton:!1},{name:"Tension grille",totalsRowFunction:"none",filterButton:!1},{name:"Courant cathode",totalsRowLabel:"none",filterButton:!1},{name:"Résistance interne",totalsRowFunction:"none",filterButton:!1},{name:"Transductance",totalsRowFunction:"none",filterButton:!1},{name:"Facteur d'amplification",totalsRowFunction:"none",filterButton:!1}],rows:[]});t.forEach((function(t){e.forEach((function(e){var n=e.selectedUgrid;if(null!==n){var r=[t,e.name,n],a=[Re(e,t),ke(e,t),Ae(e,t),Se(e,t)],u=["mA","kOhm","mA/V (mS)",""];a.forEach((function(e,t){r.push("string"===typeof e?"/":"".concat(e," ").concat(u[t]))})),o.addRow(r),o.commit()}}))})),n.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});he["saveAs"](t,"lampemetre-".concat((new Date).valueOf(),".xlsx"))}))},Ne=function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[],r=new we["Workbook"],e.next=4,r.xlsx.load(t);case 4:return o=e.sent,o.eachSheet((function(e){if("Mesures"!==e.name){for(var t=new ge(e.name),r=[],o=e.getRow(1),a=/[-+]?\d+(\.\d*)?/,u="Valeur de tension de grille non trouvée dans l'en-tête du tube ".concat(e.name),i=2;i<e.columnCount+1;i+=3){var s=o.getCell(i).value;if(null===s||void 0===s)throw new Error(u);var c=s.toString().match(a);if(null===c||void 0===c)throw new Error(u);var l=Number.parseFloat(c.toString());r.push(new ve([],l,[]))}e.eachRow((function(t,n){if(1!==n)for(var o=1;o<e.columnCount;o+=3){var a=r[Math.floor(o/3)],u=t.getCell(o).value,i=t.getCell(o+1).value;if(null!==u&&void 0!==u&&null!==i&&void 0!==i){var s=Number.parseFloat(u.toString()),c=Number.parseFloat(i.toString()),l="Erreur lors de la lecture de la catpure de tension grille ".concat(a.uGrid,".\n\n                Valeur non numérique trouvée: ");if(Number.isNaN(s))throw new Error("".concat(l,"'").concat(u,"' (tension anode)"));if(Number.isNaN(c))throw new Error("".concat(l,"'").concat(i,"' (intensité cathode)"));a.uAnode.push(s),a.iCathode.push(c)}}})),r.forEach((function(e){t.createCapture(e.uAnode,e.uGrid,e.iCathode)})),n.push(t)}})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$e=Object(r["i"])({name:"SaveLoad.vue",components:{LoadFile:me},events:["errorTriggered"],methods:{saveJSON:function(){var e=this.$store.state,t=e.tubes,n=e.measurements,r=e.notes;Ce(t,Object(ce["a"])(n.values()),r)},loadJSON:function(e){var t=this;try{var n=Ee(e),r=n.tubes,o=n.measurements,a=n.notes;r.forEach((function(e){t.$store.dispatch("ADD_TUBE",{tube:e})})),o.forEach((function(e){t.$store.dispatch("ADD_MEASUREMENT",{uAnode:e})})),void 0!==a&&this.$store.dispatch("SET_NOTES",{newNotes:a})}catch(u){this.$emit("errorTriggered",{errorMessage:u.message,errorSource:"Chargement JSON"})}},exportExcel:function(){var e=this.$store.state,t=e.tubes,n=e.measurements;_e(t,Object(ce["a"])(n.values()))},importExcel:function(e){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ne(e);case 3:r=n.sent,r.forEach((function(e){t.$store.dispatch("ADD_TUBE",{tube:e})})),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](0),t.$emit("errorTriggered",{errorMessage:n.t0.message,errorSource:"Chargement Excel"});case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()}}});n("e1af");const Ue=V()($e,[["render",se],["__scopeId","data-v-60679c2d"]]);var Pe=Ue,Ie=Object(r["i"])({name:"HeaderBar",components:{Timer:q,SaveLoad:Pe},emits:["errorTriggered"]});n("259b");const De=V()(Ie,[["render",O],["__scopeId","data-v-6aa529e9"]]);var Be=De,Fe=function(e){return Object(r["p"])("data-v-21fcc49c"),e=e(),Object(r["o"])(),e},Le={class:"chart_tubes_notes d-flex"},Ge={class:"d-block"},Ve={class:"notes ms-4"},ze={class:"header"},qe=Fe((function(){return Object(r["f"])("h3",null," Notes ",-1)})),Je={class:"info_bulle bi bi-question-circle-fill text-secondary",title:"Utilisez cette zone de texte pour écrire les notes de votre choix.\n          Celles ci seront sauvegardées avec le projet","data-bs-toggle":"tooltip","data-bs-placement":"bottom"},He={class:"mt-2 ms-4"};function Ke(e,t,n,o,a,u){var i=Object(r["t"])("Chart"),s=Object(r["t"])("TubesList"),c=Object(r["t"])("MeasurementsList"),l=Object(r["u"])("tooltip");return Object(r["n"])(),Object(r["e"])(r["a"],null,[Object(r["f"])("div",Le,[Object(r["f"])("div",Ge,[Object(r["h"])(i,{onAddMeasurement:e.addMeasurement,onRemoveMeasurement:e.removeMeasurement},null,8,["onAddMeasurement","onRemoveMeasurement"]),Object(r["f"])("div",Ve,[Object(r["f"])("div",ze,[qe,Object(r["A"])(Object(r["f"])("i",Je,null,512),[[l]])]),Object(r["A"])(Object(r["f"])("textarea",{"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.notes=t})},null,512),[[r["x"],e.notes]])])]),Object(r["h"])(s)]),Object(r["f"])("div",He,[Object(r["h"])(c)])],64)}var Qe={ref:"chart"};function We(e,t,n,o,a,u){return Object(r["n"])(),Object(r["e"])("div",Qe,null,512)}n("a434");var Ye=n("9c7d"),Xe=Object(r["i"])({name:"Chart",emits:["addMeasurement","removeMeasurement"],data:function(){var e=null,t=[],n=[],r={width:870,height:650,shapes:n,xaxis:{title:"Tension anode (V)",titlefont:{size:18}},yaxis:{title:"Intensité cathode (mA)",titlefont:{size:18}},legend:{title:{text:"Tension grille"}}};return{rootHtml:e,curves:t,annotations:n,layout:r}},mounted:function(){var e=this;this.rootHtml=this.$refs.chart,Object(Ye["newPlot"])(this.rootHtml,this.curves,this.layout),this.rootHtml.on("plotly_click",(function(t){var n=t.points[0].x;e.$store.state.measurements.has(n)?e.$emit("removeMeasurement",n):e.$emit("addMeasurement",n)})),this.refresh()},computed:{tubes:function(){return this.$store.state.tubes},measurements:function(){return this.$store.state.measurements}},watch:{tubes:{handler:function(){this.refreshTubes()},deep:!0},measurements:{handler:function(){this.refreshMeasurements()},deep:!0}},methods:{refresh:function(){this.refreshTubes(),this.refreshMeasurements()},refreshTubes:function(){var e=this;this.curves.splice(0,this.curves.length),this.$store.state.tubes.forEach((function(t){var n=e.$store.state.tubeColors.get(t);t.captures.forEach((function(t){var r={x:t.uAnode,y:t.iCathode,mode:"lines+markers",type:"scatter",marker:{color:n.toString()},name:t.toString()};e.curves.push(r)}))})),Object(Ye["redraw"])(this.rootHtml)},refreshMeasurements:function(){var e=this;this.annotations.splice(0,this.annotations.length),this.$store.state.measurements.forEach((function(t){var n=e.$store.state.measurementsColors.get(t),r={type:"line",x0:t,y0:0,x1:t,yref:"paper",y1:1,line:{color:n.toString(),width:4,dash:"dot"}};e.annotations.push(r)})),Object(Ye["redraw"])(this.rootHtml)}}});const Ze=V()(Xe,[["render",We]]);var et=Ze,tt=function(e){return Object(r["p"])("data-v-209cc72e"),e=e(),Object(r["o"])(),e},nt={class:"d-block"},rt={class:"header"},ot=tt((function(){return Object(r["f"])("h2",null,"Mesures",-1)})),at={class:"btn-group ms-3 align-bottom",role:"group","aria-label":"measurement-control"},ut=tt((function(){return Object(r["f"])("i",{class:"bi bi-plus-lg"},null,-1)})),it=[ut],st=tt((function(){return Object(r["f"])("i",{class:"bi bi-trash"},null,-1)})),ct=[st],lt={class:"mt-3"},dt=tt((function(){return Object(r["f"])("p",null,[Object(r["g"])("Entrez la "),Object(r["f"])("b",null,"tension anode"),Object(r["g"])(" pour laquelle vous souhaitez effectuer la capture.")],-1)})),bt=tt((function(){return Object(r["f"])("p",null,"Appuyez sur ',' pour entrer une autre valeur de tension anode.",-1)}));function ft(e,t,n,o,a,u){var i=this,s=Object(r["t"])("Measurement"),c=Object(r["t"])("ModalConfirm"),l=Object(r["t"])("ModalPromptNumbers");return Object(r["n"])(),Object(r["e"])(r["a"],null,[Object(r["f"])("div",nt,[Object(r["f"])("div",rt,[ot,Object(r["f"])("div",at,[Object(r["f"])("button",{type:"button",class:"btn btn-dark",onClick:t[0]||(t[0]=function(t){return e.promptMeasurementsModal.show()})},it),Object(r["f"])("button",{type:"button",class:"btn btn-outline-dark",onClick:t[1]||(t[1]=function(t){return e.clearMeasurementsModal.show()})},ct)])]),Object(r["f"])("ul",lt,[(Object(r["n"])(!0),Object(r["e"])(r["a"],null,Object(r["r"])(this.measurements,(function(t){return Object(r["n"])(),Object(r["e"])("li",{class:"d-inline-block me-3 mb-3",key:t},[Object(r["h"])(s,{uAnode:t,onMeasurementRemoved:function(n){return e.removeMeasurement(t)}},null,8,["uAnode","onMeasurementRemoved"])])})),128))])]),Object(r["h"])(c,{body:"Voulez vous vraiment supprimer toutes les mesures ?",onConfirmed:e.clearMeasurements,onModalCreated:t[2]||(t[2]=function(e){return i.clearMeasurementsModal=e})},null,8,["onConfirmed"]),Object(r["h"])(l,{title:"Nouvelle mesure",onModalCreated:t[3]||(t[3]=function(e){return i.promptMeasurementsModal=e}),onPromptDone:e.addMeasurements},{default:Object(r["z"])((function(){return[dt,bt]})),_:1},8,["onPromptDone"])],64)}n("f00c");var pt=function(e){return Object(r["p"])("data-v-d222a206"),e=e(),Object(r["o"])(),e},mt={class:"header text-center mb-2"},ht=pt((function(){return Object(r["f"])("i",{class:"bi bi-trash"},null,-1)})),vt=[ht],Ot={class:"table table-striped table-bordered d-inline"},jt={key:0},gt=pt((function(){return Object(r["f"])("th",{scope:"col"},null,-1)})),Ct=pt((function(){return Object(r["f"])("th",{scope:"col"},"Courant cathode",-1)})),Et=pt((function(){return Object(r["f"])("th",{scope:"col"},"Résistance",-1)})),wt=pt((function(){return Object(r["f"])("th",{scope:"col"},"Transductance",-1)})),yt=pt((function(){return Object(r["f"])("th",{scope:"col"},"μ (coef)",-1)})),xt=[gt,Ct,Et,wt,yt],Mt=pt((function(){return Object(r["f"])("i",{class:"bi bi-infinity me-2"},null,-1)})),Tt=["title"];function Rt(e,t,n,o,a,u){var i=Object(r["u"])("tooltip");return Object(r["n"])(),Object(r["e"])(r["a"],null,[Object(r["f"])("div",mt,[Object(r["f"])("div",{class:"colorTip d-inline-block align-bottom me-2",style:Object(r["m"])(e.setMeasurementColor())},null,4),Object(r["f"])("h3",null,Object(r["v"])(e.uAnode)+" V",1),Object(r["f"])("button",{type:"button",class:"btn btn-outline-dark ms-2 align-bottom",onClick:t[0]||(t[0]=function(t){return e.removeMeasurement()})},vt)]),Object(r["f"])("table",Ot,[Object(r["f"])("thead",null,[this.tubes.length>0?(Object(r["n"])(),Object(r["e"])("tr",jt,xt)):Object(r["d"])("",!0)]),Object(r["f"])("tbody",null,[(Object(r["n"])(!0),Object(r["e"])(r["a"],null,Object(r["r"])(e.measurementResults,(function(t,n){return Object(r["n"])(),Object(r["e"])("tr",{key:n},[Object(r["f"])("th",{scope:"col",style:Object(r["m"])(e.setTubeColor(t.tube))},Object(r["v"])(t.tube.name),5),(Object(r["n"])(!0),Object(r["e"])(r["a"],null,Object(r["r"])(t.results,(function(t,n){return Object(r["n"])(),Object(r["e"])("td",{class:"text-center",key:n},["number"===typeof t?(Object(r["n"])(),Object(r["e"])(r["a"],{key:0},[Number.isFinite(t)?(Object(r["n"])(),Object(r["e"])(r["a"],{key:0},[Object(r["g"])(Object(r["v"])(t.toFixed(1))+" "+Object(r["v"])(e.units[n]),1)],64)):(Object(r["n"])(),Object(r["e"])(r["a"],{key:1},[Mt,Object(r["f"])("span",null,Object(r["v"])(e.units[n]),1)],64))],64)):Object(r["A"])((Object(r["n"])(),Object(r["e"])("i",{key:1,class:"icon bi bi-exclamation-triangle-fill",title:t},null,8,Tt)),[[i]])])})),128))])})),128))])])],64)}n("d81d");var kt=Object(r["i"])({name:"Measurement",emits:["measurementRemoved"],props:{uAnode:Number},data:function(){return{units:["mA","kOhm","mA/V (mS)",""]}},computed:{tubes:function(){return this.$store.state.tubes},measurementResults:function(){var e=this;return this.$store.state.tubes.map((function(t){var n=e.uAnode,r={tube:t,results:[Re(t,n),ke(t,n),Ae(t,n),Se(t,n)]};return r}))}},methods:{removeMeasurement:function(){this.$emit("measurementRemoved")},setMeasurementColor:function(){var e="rgba(0, 0, 0, 1)";return void 0!==this.uAnode&&(e=this.$store.state.measurementsColors.get(this.uAnode).toString()),{"background-color":e}},setTubeColor:function(e){var t=this.$store.state.tubeColors.get(e);return void 0===t?"":{"border-left":"0.35rem solid ".concat(t.toString())}}}});n("43d1");const At=V()(kt,[["render",Rt],["__scopeId","data-v-d222a206"]]);var St=At,_t=Object(r["f"])("div",{class:"modal-header"},[Object(r["f"])("h5",{class:"modal-title"},"Confirmation"),Object(r["f"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1),Nt={class:"modal-body"},$t={class:"modal-footer"},Ut=Object(r["f"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Annuler",-1);function Pt(e,t,n,o,a,u){var i=Object(r["t"])("ModalPopup");return Object(r["n"])(),Object(r["c"])(i,{onModalCreated:t[1]||(t[1]=function(t){return e.$emit("modalCreated",t)}),onEnterPressed:t[2]||(t[2]=function(t){return e.$emit("confirmed")})},{default:Object(r["z"])((function(){return[_t,Object(r["f"])("div",Nt,Object(r["v"])(e.body),1),Object(r["f"])("div",$t,[Ut,Object(r["f"])("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[0]||(t[0]=function(t){return e.$emit("confirmed")})}," Oui ")])]})),_:1})}var It={class:"modal-dialog"},Dt={class:"modal-content"};function Bt(e,t,n,o,a,u){return Object(r["n"])(),Object(r["e"])("div",Object(r["k"])({class:"modal fade",ref:"modal",tabindex:"-1",onKeypress:t[0]||(t[0]=function(){return e.isEnterKey&&e.isEnterKey.apply(e,arguments)})},Object(r["w"])({"show.bs.modal":function(){e.$emit("show")},"shown.bs.modal":function(){e.$emit("shown")}})),[Object(r["f"])("div",It,[Object(r["f"])("div",Dt,[Object(r["s"])(e.$slots,"default")])])],16)}var Ft=Object(r["i"])({name:"ModalPopup",emits:["show","shown","modalCreated","enterPressed"],data:function(){return{modal:null}},mounted:function(){var e=this.$refs.modal;this.modal=new o["a"](e),this.$emit("modalCreated",this.modal)},methods:{isEnterKey:function(e){13===e.keyCode&&(this.modal.hide(),this.$emit("enterPressed"))}}});const Lt=V()(Ft,[["render",Bt]]);var Gt=Lt,Vt=Object(r["i"])({name:"ModalConfirm",components:{ModalPopup:Gt},props:{body:String},emits:["confirmed","modalCreated"]});const zt=V()(Vt,[["render",Pt]]);var qt=zt,Jt={class:"modal-header"},Ht={class:"modal-title"},Kt=Object(r["f"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1),Qt={class:"modal-body"},Wt={class:"inputs"},Yt={class:"input-group mb-3"},Xt={key:0,class:"input-group-text"},Zt=["onUpdate:modelValue","onKeypress"],en=Object(r["f"])("span",{class:"input-group-text"},"V",-1),tn=["disabled","onClick"],nn=Object(r["f"])("i",{class:"bi bi-trash"},null,-1),rn=[nn],on={class:"modal-footer"},an=Object(r["f"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Annuler ",-1);function un(e,t,n,o,a,u){var i=this,s=Object(r["t"])("ModalPopup");return Object(r["n"])(),Object(r["c"])(s,{onModalCreated:t[1]||(t[1]=function(t){return e.$emit("modalCreated",t)}),onEnterPressed:e.sendResults,onShow:e.resetModal,onShown:e.focusFirstInput},{default:Object(r["z"])((function(){return[Object(r["f"])("div",Jt,[Object(r["f"])("h5",Ht,Object(r["v"])(e.title),1),Kt]),Object(r["f"])("div",Qt,[Object(r["s"])(e.$slots,"default"),Object(r["f"])("div",Wt,[(Object(r["n"])(!0),Object(r["e"])(r["a"],null,Object(r["r"])(i.inputs,(function(t,n){return Object(r["n"])(),Object(r["e"])("div",{key:n},[Object(r["f"])("div",Yt,[void 0!==i.sign?(Object(r["n"])(),Object(r["e"])("span",Xt,Object(r["v"])(e.sign),1)):Object(r["d"])("",!0),Object(r["A"])(Object(r["f"])("input",{type:"text",class:Object(r["l"])(["form-control",e.inputValid(n)?"":"is-invalid"]),ref_for:!0,ref:"prompt"+n,"onUpdate:modelValue":function(e){return i.inputs[n]=e},onKeypress:function(t){return e.updateInputs(t,n)}},null,42,Zt),[[r["x"],i.inputs[n]]]),en,Object(r["f"])("button",{class:"btnRemovePrompt btn btn-outline-dark",disabled:0===n&&1===i.inputs.length,type:"button",onClick:function(t){return e.deleteInput(n)}},rn,8,tn)])])})),128))])]),Object(r["f"])("div",on,[an,Object(r["f"])("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",ref:"confirmBtn",onClick:t[0]||(t[0]=function(){return e.sendResults&&e.sendResults.apply(e,arguments)})}," Valider ",512)])]})),_:3},8,["onEnterPressed","onShow","onShown"])}n("4de4");var sn=Object(r["i"])({name:"ModalPromptNumbers",components:{ModalPopup:Gt},props:{title:String,sign:String},emits:["modalCreated","promptDone"],data:function(){return{inputs:[""]}},methods:{updateInputs:function(e,t){var n=this;44===e.keyCode?(t===this.inputs.length-1&&(this.inputs.push(""),this.$nextTick((function(){var e=n.$refs["prompt".concat(n.inputs.length-1)][0];e.focus()}))),e.preventDefault()):32===e.keyCode&&e.preventDefault()},deleteInput:function(e){this.inputs.splice(e,1)},inputValid:function(e){var t=this.inputs[e];if(""===t)return!0;var n=Number.parseFloat(t);return!Number.isNaN(n)},sendResults:function(){var e=this.inputs.map((function(e){return Number.parseFloat(e)})).filter((function(e){return!Number.isNaN(e)}));this.$emit("promptDone",e)},resetModal:function(){this.inputs=[""]},focusFirstInput:function(){var e=this.$refs.prompt0[0];e.focus()}}});const cn=V()(sn,[["render",un]]);var ln=cn,dn=Object(r["i"])({name:"MeasurementsList",components:{Measurement:St,ModalConfirm:qt,ModalPromptNumbers:ln},data:function(){return{clearMeasurementsModal:null,promptMeasurementsModal:null}},computed:{measurements:function(){return this.$store.state.measurements}},methods:{promptMeasurement:function(){var e=prompt("Tension anode de mesure");if(null!==e){var t=Number.parseFloat(e);Number.isNaN(t)||this.addMeasurement(t)}},addMeasurements:function(e){var t=this;e.forEach((function(e){t.addMeasurement(e)}))},addMeasurement:function(e){this.$store.dispatch("ADD_MEASUREMENT",{uAnode:e})},removeMeasurement:function(e){this.$store.dispatch("REMOVE_MEASUREMENT",{uAnode:e})},clearMeasurements:function(){this.$store.dispatch("CLEAR_MEASUREMENTS")}}});n("a94e");const bn=V()(dn,[["render",ft],["__scopeId","data-v-209cc72e"]]);var fn=bn,pn=function(e){return Object(r["p"])("data-v-3734bcca"),e=e(),Object(r["o"])(),e},mn={class:"tubes"},hn={class:"header ms-4"},vn=pn((function(){return Object(r["f"])("h2",null,"Tubes",-1)})),On={class:"btn-group ms-3 align-bottom",role:"group","aria-label":"tubes-control"},jn=pn((function(){return Object(r["f"])("i",{class:"bi bi-plus-lg"},null,-1)})),gn=[jn],Cn=pn((function(){return Object(r["f"])("i",{class:"bi bi-trash"},null,-1)})),En=[Cn],wn={class:"d-flex flex-wrap align-items-stretch gap-3 mt-3"},yn=pn((function(){return Object(r["f"])("p",null,"Entrez le nom du nouveau tube.",-1)}));function xn(e,t,n,o,a,u){var i=this,s=Object(r["t"])("Tube"),c=Object(r["t"])("ModalConfirm"),l=Object(r["t"])("ModalPromptText");return Object(r["n"])(),Object(r["e"])(r["a"],null,[Object(r["f"])("div",mn,[Object(r["f"])("div",hn,[vn,Object(r["f"])("div",On,[Object(r["f"])("button",{type:"button",class:"btn btn-dark",onClick:t[0]||(t[0]=function(e){return i.newTubeModal.show()})},gn),Object(r["f"])("button",{type:"button",class:"btn btn-outline-dark",onClick:t[1]||(t[1]=function(e){return i.clearTubesModal.show()})},En)])]),Object(r["f"])("ul",wn,[(Object(r["n"])(!0),Object(r["e"])(r["a"],null,Object(r["r"])(this.tubes,(function(t,n){return Object(r["n"])(),Object(r["e"])("li",{class:"d-flex",key:n},[Object(r["h"])(s,{tube:t,onSelectedCaptureChanged:function(n){return e.selectCaptureTube(t,n)},onCaptureRequested:function(n){return e.runCapture(t,n)},onCaptureRemoved:function(n){return e.removeCapture(t,n)},onTubeRemoved:function(n){return e.removeTube(t)},onSmoothingFactorChanged:function(n){return e.changeSmoothingFactor(t,n)},onPendingCaptureCanceled:function(n){return e.cancelPendingCapture(t,n)},onCrashedCaptureRemoved:function(n){return e.removeCrashedCapture(t,n)}},null,8,["tube","onSelectedCaptureChanged","onCaptureRequested","onCaptureRemoved","onTubeRemoved","onSmoothingFactorChanged","onPendingCaptureCanceled","onCrashedCaptureRemoved"])])})),128))])]),Object(r["h"])(c,{body:"Voulez vous vraiment supprimer tous les tubes ?",onConfirmed:e.clearTubes,onModalCreated:t[2]||(t[2]=function(e){return i.clearTubesModal=e})},null,8,["onConfirmed"]),Object(r["h"])(l,{title:"Nouveau tube",onModalCreated:t[3]||(t[3]=function(e){return i.newTubeModal=e}),onPromptDone:e.createTube},{default:Object(r["z"])((function(){return[yn]})),_:1},8,["onPromptDone"])],64)}var Mn=n("3835"),Tn=function(e){return Object(r["p"])("data-v-8555e2e6"),e=e(),Object(r["o"])(),e},Rn={class:"card"},kn={class:"p-2"},An=Tn((function(){return Object(r["f"])("i",{class:"bi bi-trash"},null,-1)})),Sn=[An],_n={class:"card-body p-2"},Nn={class:"card-text mb-2"},$n=Tn((function(){return Object(r["f"])("span",{class:"flex-fill"},"Nouvelle capture",-1)})),Un=Tn((function(){return Object(r["f"])("i",{class:"bi bi-plus-circle"},null,-1)})),Pn=[$n,Un],In={class:"flex-fill p-2"},Dn={class:"form-check-label flex-fill d-flex gap-2 align-items-center"},Bn=["checked","value"],Fn=["onClick"],Ln=Tn((function(){return Object(r["f"])("i",{class:"bi bi-trash"},null,-1)})),Gn=[Ln],Vn={class:"defective_captures list-group"},zn={class:"flex-fill p-2"},qn={class:"flex-fill d-flex gap-2"},Jn={class:"spinner-border spinner-border-sm text-primary",role:"status","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"En attente"},Hn={class:"opacity-50"},Kn=["onClick"],Qn=Tn((function(){return Object(r["f"])("i",{class:"bi bi-trash"},null,-1)})),Wn=[Qn],Yn={class:"flex-fill p-2"},Xn={class:"flex-fill d-flex gap-2"},Zn=["title"],er={class:"opacity-50"},tr={class:"btn-group",role:"group"},nr=["onClick"],rr=Tn((function(){return Object(r["f"])("i",{class:"bi bi-arrow-clockwise"},null,-1)})),or=[rr],ar=["onClick"],ur=Tn((function(){return Object(r["f"])("i",{class:"bi bi-trash"},null,-1)})),ir=[ur],sr={class:"card-footer"},cr={class:"d-flex gap-2"},lr={"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Détermine la correction de bruit sur les captures."},dr=Object(r["g"])(" Lissage "),br=[dr],fr=["min","max","value","disabled"],pr=Tn((function(){return Object(r["f"])("p",null,[Object(r["g"])("Entrez la "),Object(r["f"])("b",null,"tension grille"),Object(r["g"])(" pour laquelle vous souhaitez effectuer la capture.")],-1)})),mr=Tn((function(){return Object(r["f"])("p",null,"Appuyez sur ',' pour entrer une autre valeur de tension grille.",-1)})),hr=Tn((function(){return Object(r["f"])("p",null,"La tension grille sera implicitement négative.",-1)}));function vr(e,t,n,o,a,u){var i=this,s=Object(r["t"])("ModalPromptNumbers"),c=Object(r["u"])("tooltip");return Object(r["n"])(),Object(r["e"])(r["a"],null,[Object(r["f"])("div",Rn,[Object(r["f"])("div",{class:"card-header p-0 d-flex justify-content-between",style:Object(r["m"])({"border-top":"0.35rem solid ".concat(e.setColor())})},[Object(r["f"])("h5",kn,Object(r["v"])(e.tube.name),1),Object(r["f"])("button",{type:"button",class:"btn btn-outline-danger border-0",onClick:t[0]||(t[0]=function(t){return e.removeTube()})},Sn)],4),Object(r["f"])("div",_n,[Object(r["f"])("p",Nn,[Object(r["f"])("button",{type:"button",class:"btn btn-outline-primary w-100 d-flex gap-2 align-items-center",onClick:t[1]||(t[1]=function(e){return i.promptCaptureModal.show()})},Pn)]),Object(r["f"])("ul",{class:Object(r["l"])(["list-group",e.tube.captures.size>0?"mb-2":""])},[(Object(r["n"])(!0),Object(r["e"])(r["a"],null,Object(r["r"])(e.tube.captures,(function(n){var o=Object(Mn["a"])(n,2),a=o[0],u=o[1];return Object(r["n"])(),Object(r["e"])("li",{class:"capture list-group-item d-flex p-0",key:a},[Object(r["f"])("div",In,[Object(r["f"])("label",Dn,[Object(r["f"])("input",{type:"radio",checked:e.tube.selectedUgrid===a,value:a,onChange:t[2]||(t[2]=function(){return e.selectedCaptureChanged&&e.selectedCaptureChanged.apply(e,arguments)})},null,40,Bn),Object(r["f"])("div",null,Object(r["v"])(u.toString()),1)])]),Object(r["f"])("button",{type:"button",class:"btn btn-outline-danger border-0",onClick:function(t){return e.removeCapture(a)}},Gn,8,Fn)])})),128))],2),Object(r["f"])("ul",Vn,[(Object(r["n"])(!0),Object(r["e"])(r["a"],null,Object(r["r"])(e.defectiveCaptures,(function(t,n){return Object(r["n"])(),Object(r["e"])("li",{class:"list-group-item d-flex p-0",key:n},[null===t.errorMessage?(Object(r["n"])(),Object(r["e"])(r["a"],{key:0},[Object(r["f"])("div",zn,[Object(r["f"])("div",qn,[Object(r["A"])(Object(r["f"])("div",Jn,null,512),[[c]]),Object(r["f"])("label",Hn,"-"+Object(r["v"])(t.uGrid)+"V",1)])]),Object(r["f"])("button",{type:"button",class:"btn btn-outline-dark border-0",onClick:function(n){return e.cancelPendingCapture(t.uGrid)}},Wn,8,Kn)],64)):(Object(r["n"])(),Object(r["e"])(r["a"],{key:1},[Object(r["f"])("div",Yn,[Object(r["f"])("div",Xn,[Object(r["A"])(Object(r["f"])("i",{class:"bi bi-exclamation-triangle-fill text-danger",title:t.errorMessage},null,8,Zn),[[c]]),Object(r["f"])("label",er,"-"+Object(r["v"])(t.uGrid)+"V",1)])]),Object(r["f"])("div",tr,[Object(r["f"])("button",{type:"button",class:"btn btn-outline-dark border-0",onClick:function(n){return e.retryCrashedCapture(t.uGrid)}},or,8,nr),Object(r["f"])("button",{type:"button",class:"btn btn-outline-dark border-0",onClick:function(n){return e.removeCrashedCapture(t.uGrid)}},ir,8,ar)])],64))])})),128))])]),Object(r["f"])("div",sr,[Object(r["f"])("label",cr,[Object(r["A"])((Object(r["n"])(),Object(r["e"])("span",lr,br)),[[c]]),Object(r["f"])("input",{type:"range",class:"form-range",min:e.minSmoothingFactor,max:e.maxSmoothingFactor,value:e.tube.smoothingFactor,disabled:!e.tube.canChangeSmoothingFactor()||e.pendingCaptures.length>0,onChange:t[3]||(t[3]=function(){return e.smoothingFactorChanged&&e.smoothingFactorChanged.apply(e,arguments)})},null,40,fr)])])]),Object(r["h"])(s,{title:"Nouvelle capture",sign:"-",onModalCreated:t[4]||(t[4]=function(e){return i.promptCaptureModal=e}),onPromptDone:e.runCaptures},{default:Object(r["z"])((function(){return[pr,mr,hr]})),_:1},8,["onPromptDone"])],64)}var Or=Object(r["i"])({name:"Tube",components:{ModalPromptNumbers:ln},emits:["selectedCaptureChanged","captureRequested","captureRemoved","tubeRemoved","smoothingFactorChanged","pendingCaptureCanceled","crashedCaptureRemoved"],props:{tube:ge},data:function(){return{minSmoothingFactor:Oe,maxSmoothingFactor:je,promptCaptureModal:null}},computed:{defectiveCaptures:function(){var e=this.pendingCaptures.map((function(e){return{uGrid:e,errorMessage:null}}));return e=e.concat(this.crashedCaptures),e.sort((function(e,t){return e.uGrid-t.uGrid})),e},pendingCaptures:function(){var e=this;if(void 0===this.tube)return[];var t=this.$store.state.captureModule.waitingQueue;return t.filter((function(t){return t.tube===e.tube})).map((function(e){return e.uGrid}))},crashedCaptures:function(){var e=this;if(void 0===this.tube)return[];var t=this.$store.state.captureModule.graveyard;return t.filter((function(t){return t.job.tube===e.tube})).map((function(e){return{uGrid:e.job.uGrid,errorMessage:e.error}}))}},methods:{runCaptures:function(e){var t=this;e.forEach((function(e){t.$emit("captureRequested",e)}))},removeCapture:function(e){this.$emit("captureRemoved",e)},removeTube:function(){this.$emit("tubeRemoved")},selectedCaptureChanged:function(e){var t=Number.parseFloat(e.target.value);this.$emit("selectedCaptureChanged",t)},smoothingFactorChanged:function(e){var t=Number.parseInt(e.target.value,10);this.$emit("smoothingFactorChanged",t)},setColor:function(){var e="rgba(0, 0, 0, 1)";return void 0!==this.tube&&(e=this.$store.state.tubeColors.get(this.tube).toString()),e},cancelPendingCapture:function(e){this.$emit("pendingCaptureCanceled",e)},removeCrashedCapture:function(e){this.$emit("crashedCaptureRemoved",e)},retryCrashedCapture:function(e){this.$emit("captureRequested",e)}}});n("ce13");const jr=V()(Or,[["render",vr],["__scopeId","data-v-8555e2e6"]]);var gr=jr,Cr={class:"modal-header"},Er={class:"modal-title"},wr=Object(r["f"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1),yr={class:"modal-body"},xr={class:"modal-footer"},Mr=Object(r["f"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Annuler ",-1);function Tr(e,t,n,o,a,u){var i=Object(r["t"])("ModalPopup");return Object(r["n"])(),Object(r["c"])(i,{onModalCreated:t[2]||(t[2]=function(t){return e.$emit("modalCreated",t)}),onEnterPressed:e.sendResult,onShow:e.resetInput,onShown:e.focusInput},{default:Object(r["z"])((function(){return[Object(r["f"])("div",Cr,[Object(r["f"])("h5",Er,Object(r["v"])(e.title),1),wr]),Object(r["f"])("div",yr,[Object(r["s"])(e.$slots,"default"),Object(r["A"])(Object(r["f"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.text=t}),type:"text",class:"form-control",ref:"textInput"},null,512),[[r["x"],e.text]])]),Object(r["f"])("div",xr,[Mr,Object(r["f"])("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[1]||(t[1]=function(t){return e.sendResult()})}," Oui ")])]})),_:3},8,["onEnterPressed","onShow","onShown"])}var Rr=Object(r["i"])({name:"ModalPromptText",components:{ModalPopup:Gt},emits:["modalCreated","promptDone"],props:{title:String},data:function(){return{text:""}},methods:{resetInput:function(){this.text=""},focusInput:function(){var e=this.$refs.textInput;e.focus()},sendResult:function(){this.$emit("promptDone",this.text)}}});const kr=V()(Rr,[["render",Tr]]);var Ar=kr,Sr=Object(r["i"])({name:"TubesList",components:{Tube:gr,ModalConfirm:qt,ModalPromptText:Ar},data:function(){return{clearTubesModal:null,newTubeModal:null}},computed:{tubes:function(){return this.$store.state.tubes}},methods:{createTube:function(e){var t=new ge(e);this.$store.dispatch("ADD_TUBE",{tube:t})},addTube:function(){var e=prompt("Nom du tube");if(null!==e){var t=new ge(e);this.$store.dispatch("ADD_TUBE",{tube:t})}},clearTubes:function(){this.$store.dispatch("EMPTY_TUBES")},selectCaptureTube:function(e,t){this.$store.dispatch("SELECT_CAPTURE_TUBE",{tube:e,uGrid:t})},runCapture:function(e,t){this.$store.dispatch("CREATE_CAPTURE_ASYNC",{tube:e,uGrid:t})},removeCapture:function(e,t){this.$store.dispatch("DELETE_CAPTURE",{tube:e,uGrid:t})},removeTube:function(e){this.$store.dispatch("REMOVE_TUBE",{tube:e})},changeSmoothingFactor:function(e,t){this.$store.dispatch("CHANGE_SMOOTHING_FACTOR",{tube:e,smoothingFactor:t})},cancelPendingCapture:function(e,t){this.$store.dispatch("CANCEL_PENDING_CAPTURE",{tube:e,uGrid:t})},removeCrashedCapture:function(e,t){this.$store.dispatch("REMOVE_CRASHED_CAPTURE",{tube:e,uGrid:t})}}});n("6a72");const _r=V()(Sr,[["render",xn],["__scopeId","data-v-3734bcca"]]);var Nr=_r,$r=Object(r["i"])({name:"Workspace",components:{Chart:et,MeasurementsList:fn,TubesList:Nr},computed:{notes:{get:function(){return this.$store.state.notes},set:function(e){this.$store.dispatch("SET_NOTES",{newNotes:e})}}},methods:{addMeasurement:function(e){this.$store.dispatch("ADD_MEASUREMENT",{uAnode:e})},removeMeasurement:function(e){this.$store.dispatch("REMOVE_MEASUREMENT",{uAnode:e})}}});n("2275");const Ur=V()($r,[["render",Ke],["__scopeId","data-v-21fcc49c"]]);var Pr=Ur,Ir=Object(r["i"])({name:"App",components:{Workspace:Pr,HeaderBar:Be},data:function(){return{toast:null,errorMessage:"",errorSource:""}},mounted:function(){var e=this.$refs.errorToast;this.toast=new o["c"](e)},methods:{triggerError:function(e){var t=e.errorMessage,n=e.errorSource;this.errorMessage=t,this.errorSource=n,null!==this.toast&&this.toast.show()}}});const Dr=V()(Ir,[["render",f]]);var Br,Fr=Dr,Lr=n("5502"),Gr=(n("6062"),n("abaf")),Vr=(n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("fb6a"),function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=new Uint8Array([n]),e.next=3,t.write(r);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),zr=function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=0,o=[];case 2:if(!(r<n)){e.next=13;break}return e.next=5,t.read();case 5:if(a=e.sent,u=a.value,u){e.next=9;break}throw Error("read value is empty");case 9:for(i=0;i<u.length;i+=1)o.push(u[i]);r+=u.length,e.next=2;break;case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),qr=function(e,t,n){return new Promise((function(r,o){zr(e,t).then(r,o),setTimeout((function(){o(Error("Timeout while reading"))}),n)}))},Jr=function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,n,r){var o,a,u,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n%2===0){e.next=2;break}throw Error("n_bytes must be even to pack reading result in 16-bits words");case 2:return e.next=4,qr(t,n,r);case 4:for(o=e.sent,a=[],u=0;u<o.length;u+=2)i=(o[u]<<8)+o[u+1],a.push(i);return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Hr=function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=[],e.prev=1,e.next=4,Vr(n,101);case 4:return o=128,e.next=7,Jr(t,o,1500);case 7:r=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e["catch"](1),Error("Impossible d'obtenir les valeurs de tension anode");case 13:for(a=[],u=0;u<r.length;u+=1)i=Math.round(4.6875*r[u])/10,a.push(i);return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}();(function(e){e[e["AN1"]=0]="AN1",e[e["AN2"]=1]="AN2"})(Br||(Br={}));var Kr=function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,n,r,o){var a,u,i,s,c,l,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=[],e.prev=1,u=o===Br.AN1?1/32:1/4,i=150+2*r,e.next=6,Vr(n,i);case 6:return s=128,e.next=9,Jr(t,s,15e3);case 9:for(c=e.sent,l=0;l<c.length;l+=1)d=c[l]*u,a.push(d);e.next=17;break;case 13:throw e.prev=13,e.t0=e["catch"](1),alert(e.t0),Error("Impossible d'obtenir les valeurs d'intensité cathode");case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n,r,o){return e.apply(this,arguments)}}(),Qr=function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.serial.getPorts();case 2:if(t=e.sent,!(t.length>0)){e.next=8;break}r=Object(Mn["a"])(t,1),n=r[0],e.next=12;break;case 8:return o=[{usbVendorId:1027,usbProductId:24577}],e.next=11,navigator.serial.requestPort({filters:o});case 11:n=e.sent;case 12:return e.next=14,n.open({baudRate:2400,dataBits:8,stopBits:2,parity:"none"});case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Wr=function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,n,r,o){var a,u,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Hr(t,n);case 2:return a=e.sent,u=o===Br.AN1?32:50,e.next=6,Vr(n,u);case 6:return e.next=8,Kr(t,n,r,o);case 8:return i=e.sent,e.next=11,Vr(n,105);case 11:return e.abrupt("return",{tensionsAnode:a,currentsCathode:i});case 12:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}(),Yr=function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,n){var r,o,a,u,i,s,c,l,d,b,f,p,m,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Qr();case 2:return r=e.sent,o=r.readable.getReader(),a=r.writable.getWriter(),e.prev=5,e.next=8,Wr(o,a,t,Br.AN1);case 8:if(u=e.sent,i=u.tensionsAnode,s=u.currentsCathode,c=.1,l=s.filter((function(e){return Math.abs(e-32)<c})),!(l.length>=5)){e.next=19;break}return e.next=16,Wr(o,a,t,Br.AN2);case 16:u=e.sent,i=u.tensionsAnode,s=u.currentsCathode;case 19:return e.prev=19,o.cancel(),o.releaseLock(),e.next=24,a.close();case 24:return e.next=26,r.close();case 26:return e.finish(19);case 27:for(d=n,b=[],f=0;f<s.length-d;f+=1)p=Math.max(0,f-d),m=Math.min(s.length-1,f+d),h=s.slice(p,m+1).reduce((function(e,t){return e+t}),0)/(m-p+1),b.push(h);return e.abrupt("return",{tensionsAnode:i,currentsCathode:b});case 31:case"end":return e.stop()}}),e,null,[[5,,19,27]])})));return function(t,n){return e.apply(this,arguments)}}(),Xr=function(){function e(t){Object(D["a"])(this,e),this.waitingQueue=[],this.graveyard=[],this.serialMutex=new Gr["a"],this.queueMutex=new Gr["a"],this.timer=t}return Object(B["a"])(e,[{key:"reportCrash",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.jobDone(t);case 2:r=e.sent,r||(o=this.graveyard.findIndex((function(e){return e.job.equals(t)})),-1!==o?this.graveyard[o].error=n:this.graveyard.push({job:t,error:n}));case 4:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"removeCrashReport",value:function(e){var t=this.graveyard.findIndex((function(t){return t.job.equals(e)}));-1!==t&&this.graveyard.splice(t,1)}},{key:"indexJob",value:function(e){return this.waitingQueue.findIndex((function(t){return e.equals(t)}))}},{key:"hasBeenCanceled",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.queueMutex.acquire();case 2:return n=e.sent,e.prev=3,e.next=6,this.indexJob(t);case 6:return e.t0=e.sent,e.t1=-1,e.abrupt("return",e.t0===e.t1);case 9:return e.prev=9,n(),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[3,,9,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"enqueueJob",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.queueMutex.acquire();case 2:if(n=e.sent,e.prev=3,r=this.indexJob(t),-1!==r){e.next=8;break}return this.waitingQueue.push(t),e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:return e.prev=9,n(),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[3,,9,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"jobDone",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.queueMutex.acquire();case 2:if(n=e.sent,e.prev=3,r=this.indexJob(t),-1!==r){e.next=7;break}return e.abrupt("return",!0);case 7:return this.waitingQueue.splice(r,1),e.abrupt("return",!1);case 9:return e.prev=9,n(),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[3,,9,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"flushJobsTube",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.queueMutex.acquire();case 2:n=e.sent;try{this.waitingQueue=this.waitingQueue.filter((function(e){return e.tube!==t})),this.graveyard=this.graveyard.filter((function(e){return e.job.tube===t}))}finally{n()}case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"cancelJob",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.queueMutex.acquire();case 2:n=e.sent;try{r=this.indexJob(t),-1!==r&&this.waitingQueue.splice(r,1)}finally{n()}case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"doCapture",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.enqueueJob(t);case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return",null);case 5:return this.removeCrashReport(t),r=null,e.next=9,this.hasBeenCanceled(t);case 9:o=e.sent;case 10:if(o||null!==r){e.next=43;break}return e.next=13,this.serialMutex.acquire();case 13:if(a=e.sent,e.prev=14,0!==this.indexJob(t)||!this.timer.isOver()){e.next=25;break}return e.next=18,Yr(t.uGrid,t.tube.smoothingFactor);case 18:return r=e.sent,e.next=21,this.jobDone(t);case 21:o=e.sent,o&&(r=null),e.next=31;break;case 25:return e.next=27,this.hasBeenCanceled(t);case 27:if(o=e.sent,o){e.next=31;break}return e.next=31,new Promise((function(e){return setTimeout(e,200)}));case 31:e.next=38;break;case 33:return e.prev=33,e.t0=e["catch"](14),e.next=37,this.reportCrash(t,e.t0.message);case 37:return e.abrupt("return",null);case 38:return e.prev=38,a(),e.finish(38);case 41:e.next=10;break;case 43:return e.abrupt("return",r);case 44:case"end":return e.stop()}}),e,this,[[14,33,38,41]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Zr=n("a1e9"),eo=Object(Zr["l"])(new F);eo.initInterval();var to={tubes:[],measurements:new Set,tubeColors:new Map,measurementsColors:new Map,timer:eo,captureModule:new Xr(eo),notes:"Tension grille 2: "},no={},ro=n("4478"),oo=(n("7db0"),function(){function e(t,n,r,o){Object(D["a"])(this,e),this.red=t,this.green=n,this.blue=r,this.transparency=o}return Object(B["a"])(e,[{key:"toString",value:function(){return"rgba(".concat(this.red,",").concat(this.green,",").concat(this.blue,",").concat(this.transparency,")")}},{key:"equals",value:function(e){return this.red===e.red&&this.green===e.green&&this.blue===e.blue&&this.transparency===e.transparency}}]),e}()),ao=[new oo(66,165,245,1),new oo(255,23,68,1),new oo(0,191,165,1),new oo(255,234,0,1),new oo(248,187,208,1),new oo(0,229,255,1),new oo(118,255,3,1),new oo(213,0,249,1),new oo(48,79,254,1),new oo(105,240,174,1),new oo(255,145,0,1),new oo(98,0,234,1),new oo(129,212,250,1),new oo(192,202,51,1),new oo(141,110,99,1),new oo(84,110,122,1)],uo=[new oo(0,0,255,.4),new oo(255,0,0,.4),new oo(0,128,21,.4),new oo(77,0,153,.4),new oo(230,191,0,.4),new oo(93,206,216,.4),new oo(93,216,165,.4),new oo(252,126,233,.4),new oo(130,69,5,.4)],io=n("45eb"),so=n("7e84"),co=n("262e"),lo=n("2caf"),bo=n("a2bc"),fo=new oo(0,0,0,1),po=function(e){Object(co["a"])(n,e);var t=Object(lo["a"])(n);function n(){return Object(D["a"])(this,n),t.apply(this,arguments)}return Object(B["a"])(n,[{key:"pop",value:function(){return 0===this.size?fo:Object(io["a"])(Object(so["a"])(n.prototype),"pop",this).call(this)}},{key:"push",value:function(e){e.equals(fo)||Object(io["a"])(Object(so["a"])(n.prototype),"push",this).call(this,e)}}]),n}(bo["Stack"]),mo=function(){function e(t,n){Object(D["a"])(this,e),this.tube=t,this.uGrid=n}return Object(B["a"])(e,[{key:"equals",value:function(e){return this.tube===e.tube&&this.uGrid===e.uGrid}}]),e}(),ho=function(){return Object(ro["a"])(po,Object(ce["a"])(ao))},vo=function(){return Object(ro["a"])(po,Object(ce["a"])(uo))},Oo=ho(),jo=vo(),go={EMPTY_TUBES:function(e){e.tubes=[],e.tubeColors.clear(),Oo=ho()},ADD_TUBE:function(e,t){e.tubes.push(t),e.tubeColors.set(t,Oo.pop())},REMOVE_TUBE:function(e,t){var n=e.tubes.findIndex((function(e){return e===t}));if(-1!==n){e.tubes.splice(n,1);var r=e.tubeColors.get(t);e.tubeColors.delete(t),Oo.push(r),e.captureModule.flushJobsTube(t)}},CREATE_TUBE:function(e,t){this.ADD_TUBE(e,new ge(t))},CREATE_CAPTURE:function(e,t){var n=e.tubes.find((function(e){return e===t.tube}));void 0!==n&&n.createCapture(t.uAnode,t.uGrid,t.iCathode)},DELETE_CAPTURE:function(e,t){var n=e.tubes.find((function(e){return e===t.tube}));void 0!==n&&n.deleteCaptureByUgrid(t.uGrid)},SELECT_CAPTURE_TUBE:function(e,t){var n=t.tube,r=t.uGrid,o=e.tubes.find((function(e){return e===n}));if(void 0!==o){var a=o.captures.get(r);void 0!==a&&o.changeSelectedUgrid(r)}},CHANGE_SMOOTHING_FACTOR:function(e,t){var n=t.tube,r=t.smoothingFactor,o=e.tubes.find((function(e){return e===n}));void 0!==o&&o.changeSmoothingFactor(r)},ADD_MEASUREMENT:function(e,t){e.measurements.has(t)||(e.measurements.add(t),e.measurementsColors.set(t,jo.pop()))},REMOVE_MEASUREMENT:function(e,t){e.measurements.delete(t);var n=e.measurementsColors.get(t);e.measurementsColors.delete(t),jo.push(n)},CLEAR_MEASUREMENTS:function(e){e.measurements.clear(),e.measurementsColors.clear(),jo=vo()},CANCEL_PENDING_CAPTURE:function(e,t){var n=t.tube,r=t.uGrid;e.captureModule.cancelJob(new mo(n,r))},REMOVE_CRASHED_CAPTURE:function(e,t){var n=t.tube,r=t.uGrid;e.captureModule.removeCrashReport(new mo(n,r))},SET_NOTES:function(e,t){e.notes=t}},Co=go,Eo={EMPTY_TUBES:function(e){e.commit("EMPTY_TUBES",void 0)},ADD_TUBE:function(e,t){e.commit("ADD_TUBE",t.tube)},REMOVE_TUBE:function(e,t){e.commit("REMOVE_TUBE",t.tube)},CREATE_TUBE:function(e,t){e.commit("CREATE_TUBE",t.name)},CREATE_CAPTURE:function(e,t){e.commit("CREATE_CAPTURE",t)},CREATE_CAPTURE_ASYNC:function(e,t){return Object(I["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.tube,o=t.uGrid,n.next=3,e.state.captureModule.doCapture(new mo(r,o));case 3:a=n.sent,null!==a&&e.commit("CREATE_CAPTURE",{tube:r,uAnode:a.tensionsAnode,uGrid:o,iCathode:a.currentsCathode});case 5:case"end":return n.stop()}}),n)})))()},DELETE_CAPTURE:function(e,t){e.commit("DELETE_CAPTURE",t)},SELECT_CAPTURE_TUBE:function(e,t){e.commit("SELECT_CAPTURE_TUBE",t)},CHANGE_SMOOTHING_FACTOR:function(e,t){e.commit("CHANGE_SMOOTHING_FACTOR",t)},ADD_MEASUREMENT:function(e,t){e.commit("ADD_MEASUREMENT",t.uAnode)},REMOVE_MEASUREMENT:function(e,t){e.commit("REMOVE_MEASUREMENT",t.uAnode)},CLEAR_MEASUREMENTS:function(e){e.commit("CLEAR_MEASUREMENTS",void 0)},CANCEL_PENDING_CAPTURE:function(e,t){e.commit("CANCEL_PENDING_CAPTURE",t)},REMOVE_CRASHED_CAPTURE:function(e,t){e.commit("REMOVE_CRASHED_CAPTURE",t)},SET_NOTES:function(e,t){e.commit("SET_NOTES",t.newNotes)}},wo=Eo,yo=Object(Lr["a"])({state:to,getters:no,mutations:Co,actions:wo}),xo=Object(r["b"])(Fr);xo.directive("tooltip",{mounted:function(e){new o["d"](e)}}),xo.use(yo).mount("#app")},ce13:function(e,t,n){"use strict";n("26e3")},dd09:function(e,t,n){},e1af:function(e,t,n){"use strict";n("4bf0")},f27a:function(e,t,n){"use strict";n("acad")}});
//# sourceMappingURL=app.941798bc.js.map